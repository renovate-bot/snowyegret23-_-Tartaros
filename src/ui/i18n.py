from PySide6.QtCore import QObject, Signal

from settings.store import SettingsStore


_TRANSLATIONS = {
    "English": {
        "app.title": "Tartaros",
        "menu.file": "File",
        "menu.import_urls": "Import URLs...",
        "menu.settings": "Settings",
        "settings.title": "Settings",
        "settings.save": "Save",
        "settings.nav.general": "General",
        "settings.nav.download": "Download",
        "settings.nav.subs_meta": "Subtitles/Meta",
        "settings.nav.auth": "Auth",
        "settings.nav.sponsorblock": "SponsorBlock",
        "settings.nav.bundle": "Bundle",
        "settings.section.language": "Language",
        "settings.section.general": "General Settings",
        "settings.section.download": "Download Settings",
        "settings.section.subtitles": "Subtitles",
        "settings.section.metadata": "Metadata",
        "settings.section.browser_cookies": "Browser Cookies",
        "settings.section.age_restricted": "Age-restricted Content",
        "settings.section.cookies_file": "Cookies (Text)",
        "settings.section.sponsorblock": "SponsorBlock",
        "settings.section.youtube": "YouTube",
        "settings.section.bundle": "Bundled Tools",
        "settings.label.bundle.deno": "Deno",
        "settings.label.bundle.ffmpeg": "FFmpeg",
        "settings.label.bundle.path": "Path",
        "settings.label.bundle.override": "Override path",
        "settings.value.bundle.present": "Present",
        "settings.value.bundle.missing": "Missing",
        "settings.button.bundle.refresh": "Refresh",
        "settings.button.bundle.download": "Download",
        "settings.help.bundle.download": "Download links will open in your browser.",
        "settings.label.yt_player_clients": "Player Client",
        "settings.label.language": "Language",
        "settings.label.download_dir": "Download Folder",
        "settings.label.outtmpl_default": "Filename Template",
        "settings.label.outtmpl_playlist": "Playlist Template",
        "settings.label.output_format": "Output Format",
        "settings.label.video_quality": "Video Quality",
        "settings.label.audio_quality": "Audio Quality",
        "settings.label.concurrent_fragments": "Concurrent Fragments",
        "settings.label.retries": "Retry Count",
        "settings.option.prefer_largest_file": "Prefer largest file",
        "settings.label.sub_langs": "Subtitle Languages",
        "settings.label.cookies_browser": "Browser",
        "settings.label.cookies_text": "cookies.txt content",
        "settings.label.sb_remove": "Segments to Remove",
        "settings.label.sb_mark": "Mark as Chapters",
        "settings.label.yt_remote_components": "JS Challenge Solver",
        "settings.label.yt_po_token": "PO Token",
        "settings.option.remote_components.github": "Enable (GitHub)",
        "settings.option.remote_components.off": "Off",
        "settings.option.player_clients.web": "Web only",
        "settings.option.player_clients.web_android": "Web + Android",
        "settings.option.player_clients.auto": "Auto (recommended)",
        "settings.help.yt_po_token": "Enter like: android.gvs+TOKEN",
        "settings.warning.deno_missing": "Deno not found. JS challenge solving may fail.",
        "settings.warning.ffmpeg_missing": "FFmpeg not found. High-quality merge may fail (fallback to lower quality).",
        "settings.placeholder.cookies_text": "# Netscape HTTP Cookie File format",
        "settings.help.templates": "Template vars: %(title)s, %(uploader)s, %(id)s, %(ext)s, %(playlist_title)s, %(playlist_index)s etc.",
        "settings.help.cookies_desc": "To download age-restricted or members-only videos, use browser cookies.",
        "settings.help.age_desc": "To download age-restricted videos, enable 'Use browser cookies' and sign in to YouTube in that browser.",
        "settings.help.sponsorblock_desc": "Auto-remove sponsor/intro/outro etc. or mark as chapters (no API key needed).",
        "settings.help.sponsorblock_cats": "Categories: sponsor, intro, outro, selfpromo, preview, filler, interaction, music_offtopic, all",
        "settings.tooltip.verify_download": "Verify file integrity after download when Best quality is selected",
        "settings.tooltip.sub_langs": "Comma-separated (e.g., en,ja,ko)",
        "settings.tooltip.cookies_text": "Paste Netscape-format cookies.txt content (see www.youtube.com_cookies.txt format)",
        "settings.tooltip.age_restricted": "Requires a YouTube account with age verification in the selected browser",
        "settings.tooltip.sponsorblock_mark": "Categories to mark instead of remove",
        "settings.option.verify_download": "Verify downloaded files",
        "settings.option.write_subs": "Download subtitles",
        "settings.option.write_auto_subs": "Include auto-generated subtitles",
        "settings.option.embed_subs": "Embed subtitles into video",
        "settings.option.embed_thumbnail": "Embed thumbnail",
        "settings.option.embed_chapters": "Embed chapters",
        "settings.option.write_thumbnail": "Save thumbnail separately",
        "settings.option.add_metadata": "Add metadata (title, artist, etc.)",
        "settings.option.use_cookies_from_browser": "Use browser cookies",
        "settings.option.enable_age_restricted": "Allow age-restricted videos",
        "settings.option.sponsorblock_enable": "Enable SponsorBlock",
        "settings.format.mp4": "MP4 (.mp4)",
        "settings.format.mkv": "MKV (.mkv)",
        "settings.format.webm": "WebM (.webm)",
        "settings.format.mp3_audio": "MP3 (.mp3) - Audio",
        "settings.format.m4a_audio": "M4A (.m4a) - Audio",
        "settings.format.opus_audio": "Opus (.opus) - Audio",
        "settings.format.flac_audio": "FLAC (.flac) - Audio",
        "settings.video_quality.best": "Best quality (Best)",
        "settings.video_quality.2160p": "4K (2160p)",
        "settings.video_quality.1440p": "2K (1440p)",
        "settings.video_quality.1080p": "Full HD (1080p)",
        "settings.video_quality.720p": "HD (720p)",
        "settings.video_quality.480p": "SD (480p)",
        "settings.video_quality.360p": "Low quality (360p)",
        "settings.video_quality.audio_only": "Audio only",
        "settings.audio_quality.best": "Best quality (Best)",
        "downloads.url_placeholder": "Enter YouTube video/playlist URL (Ctrl+Enter)",
        "downloads.clipboard": "Clipboard",
        "downloads.clipboard_tooltip": "Auto-detect clipboard URLs",
        "downloads.sort_latest": "↓ Newest",
        "downloads.sort_oldest": "↑ Oldest",
        "downloads.download_button": "Download",
        "downloads.status.queued": "Queued",
        "downloads.status.done": "Done",
        "downloads.status.failed": "Failed",
        "downloads.error_title": "Error Details",
        "downloads.error_header": "Download Error",
        "downloads.error_copy": "Copy",
        "downloads.error_close": "Close",
        "downloads.error_button": "⚠ Error",
        "downloads.import_title": "Import",
        "downloads.import_filter": "URL List (*.txt *.csv)",
        "downloads.batch": "Batch ({count})",
        "downloads.menu.copy_link": "Copy video URL",
        "downloads.menu.restart": "Redownload",
        "downloads.menu.restart_incomplete": "Redownload all failed items",
        "downloads.menu.remove_completed": "Remove all successfully downloaded items",
        "downloads.menu.delete_item": "Delete",
        "downloads.menu.lock": "Lock",
        "dialog.select_folder": "Select Folder",
        "dialog.select_file": "Select File",
    },
    "Korean": {
        "app.title": "Tartaros",
        "menu.file": "파일",
        "menu.import_urls": "URL 불러오기...",
        "menu.settings": "설정",
        "settings.title": "설정",
        "settings.save": "저장",
        "settings.nav.general": "일반",
        "settings.nav.download": "다운로드",
        "settings.nav.subs_meta": "자막/메타",
        "settings.nav.auth": "인증",
        "settings.nav.sponsorblock": "SponsorBlock",
        "settings.nav.bundle": "번들",
        "settings.section.language": "언어 설정",
        "settings.section.general": "일반 설정",
        "settings.section.download": "다운로드 설정",
        "settings.section.subtitles": "자막",
        "settings.section.metadata": "메타데이터",
        "settings.section.browser_cookies": "브라우저 쿠키",
        "settings.section.age_restricted": "성인 콘텐츠",
        "settings.section.cookies_file": "쿠키 (텍스트)",
        "settings.section.sponsorblock": "SponsorBlock",
        "settings.section.youtube": "YouTube",
        "settings.section.bundle": "번들 도구",
        "settings.label.bundle.deno": "Deno",
        "settings.label.bundle.ffmpeg": "FFmpeg",
        "settings.label.bundle.path": "경로",
        "settings.label.bundle.override": "경로 지정",
        "settings.value.bundle.present": "감지됨",
        "settings.value.bundle.missing": "없음",
        "settings.button.bundle.refresh": "새로고침",
        "settings.button.bundle.download": "다운로드",
        "settings.help.bundle.download": "다운로드 링크는 브라우저에서 열립니다.",
        "settings.label.yt_player_clients": "플레이어 클라이언트",
        "settings.label.language": "언어",
        "settings.label.download_dir": "저장 폴더",
        "settings.label.outtmpl_default": "파일명 템플릿",
        "settings.label.outtmpl_playlist": "플레이리스트",
        "settings.label.output_format": "출력 포맷",
        "settings.label.video_quality": "화질",
        "settings.label.audio_quality": "음질",
        "settings.label.concurrent_fragments": "동시 조각 수",
        "settings.label.retries": "재시도 횟수",
        "settings.option.prefer_largest_file": "최대 파일 크기 우선",
        "settings.label.sub_langs": "자막 언어",
        "settings.label.cookies_browser": "브라우저",
        "settings.label.cookies_text": "cookies.txt 내용",
        "settings.label.sb_remove": "제거할 구간",
        "settings.label.sb_mark": "챕터로 표시",
        "settings.label.yt_remote_components": "JS 챌린지 해결",
        "settings.label.yt_po_token": "PO 토큰",
        "settings.option.remote_components.github": "사용 (GitHub)",
        "settings.option.remote_components.off": "끄기",
        "settings.option.player_clients.web": "웹만 사용",
        "settings.option.player_clients.web_android": "웹 + 안드로이드",
        "settings.option.player_clients.auto": "자동 (권장)",
        "settings.help.yt_po_token": "예: android.gvs+TOKEN",
        "settings.warning.deno_missing": "Deno가 없습니다. JS 챌린지 해결이 실패할 수 있습니다.",
        "settings.warning.ffmpeg_missing": "FFmpeg가 없습니다. 고화질 병합이 실패할 수 있습니다 (저화질로 대체됨).",
        "settings.placeholder.cookies_text": "# Netscape HTTP Cookie File 형식",
        "settings.help.templates": "템플릿 변수: %(title)s, %(uploader)s, %(id)s, %(ext)s, %(playlist_title)s, %(playlist_index)s 등",
        "settings.help.cookies_desc": "로그인이 필요한 영상(연령 제한, 멤버십 등)을 다운로드하려면\n브라우저 쿠키를 사용하세요.",
        "settings.help.age_desc": "※ 연령 제한 영상을 다운로드하려면 위의 '브라우저 쿠키 사용'을\n활성화하고, 해당 브라우저에서 YouTube에 로그인되어 있어야 합니다.",
        "settings.help.sponsorblock_desc": "스폰서, 인트로, 아웃트로 등을 자동으로 제거하거나\n챕터로 표시합니다. (API 키 불필요)",
        "settings.help.sponsorblock_cats": "카테고리: sponsor, intro, outro, selfpromo, preview, filler, interaction, music_offtopic, all",
        "settings.tooltip.verify_download": "Best 화질 선택 시 다운로드 완료 후 파일 무결성 확인",
        "settings.tooltip.sub_langs": "쉼표로 구분 (예: ko,en,ja)",
        "settings.tooltip.cookies_text": "Netscape 형식의 cookies.txt 내용을 붙여넣기 (www.youtube.com_cookies.txt 형식 참고)",
        "settings.tooltip.age_restricted": "브라우저 쿠키 사용 시 YouTube 로그인 계정의 연령 인증이 필요합니다",
        "settings.tooltip.sponsorblock_mark": "제거 대신 챕터로 표시할 카테고리",
        "settings.option.verify_download": "다운로드 후 파일 검증",
        "settings.option.write_subs": "자막 다운로드",
        "settings.option.write_auto_subs": "자동 생성 자막 포함",
        "settings.option.embed_subs": "자막을 영상에 임베드",
        "settings.option.embed_thumbnail": "썸네일 임베드",
        "settings.option.embed_chapters": "챕터 임베드",
        "settings.option.write_thumbnail": "썸네일 별도 저장",
        "settings.option.add_metadata": "메타데이터 추가 (제목, 아티스트 등)",
        "settings.option.use_cookies_from_browser": "브라우저 쿠키 사용",
        "settings.option.enable_age_restricted": "연령 제한 영상 다운로드 허용",
        "settings.option.sponsorblock_enable": "SponsorBlock 사용",
        "settings.format.mp4": "MP4 (.mp4)",
        "settings.format.mkv": "MKV (.mkv)",
        "settings.format.webm": "WebM (.webm)",
        "settings.format.mp3_audio": "MP3 (.mp3) - 오디오",
        "settings.format.m4a_audio": "M4A (.m4a) - 오디오",
        "settings.format.opus_audio": "Opus (.opus) - 오디오",
        "settings.format.flac_audio": "FLAC (.flac) - 오디오",
        "settings.video_quality.best": "최고 화질 (Best)",
        "settings.video_quality.2160p": "4K (2160p)",
        "settings.video_quality.1440p": "2K (1440p)",
        "settings.video_quality.1080p": "Full HD (1080p)",
        "settings.video_quality.720p": "HD (720p)",
        "settings.video_quality.480p": "SD (480p)",
        "settings.video_quality.360p": "저화질 (360p)",
        "settings.video_quality.audio_only": "오디오만",
        "settings.audio_quality.best": "최고 음질 (Best)",
        "downloads.url_placeholder": "YouTube 영상/플레이리스트 링크 입력 (Ctrl+Enter)",
        "downloads.clipboard": "클립보드",
        "downloads.clipboard_tooltip": "클립보드 자동 감지",
        "downloads.sort_latest": "↓ 최신순",
        "downloads.sort_oldest": "↑ 오래된순",
        "downloads.download_button": "다운로드",
        "downloads.status.queued": "대기중",
        "downloads.status.done": "완료",
        "downloads.status.failed": "실패",
        "downloads.error_title": "오류 상세",
        "downloads.error_header": "다운로드 오류",
        "downloads.error_copy": "복사",
        "downloads.error_close": "닫기",
        "downloads.error_button": "⚠ 오류",
        "downloads.import_title": "불러오기",
        "downloads.import_filter": "URL List (*.txt *.csv)",
        "downloads.batch": "일괄 ({count})",
        "downloads.menu.copy_link": "영상 주소 복사",
        "downloads.menu.restart": "다시 다운로드",
        "downloads.menu.restart_incomplete": "오류 발생한 항목 모두 다시 다운로드",
        "downloads.menu.remove_completed": "정상적으로 다운로드된 항목 모두 제거",
        "downloads.menu.delete_item": "삭제",
        "downloads.menu.lock": "잠금",
        "dialog.select_folder": "폴더 선택",
        "dialog.select_file": "파일 선택",
    },
    "Japanese": {
        "app.title": "Tartaros",
        "menu.file": "ファイル",
        "menu.import_urls": "URLを読み込む...",
        "menu.settings": "設定",
        "settings.title": "設定",
        "settings.save": "保存",
        "settings.nav.general": "一般",
        "settings.nav.download": "ダウンロード",
        "settings.nav.subs_meta": "字幕/メタ",
        "settings.nav.auth": "認証",
        "settings.nav.sponsorblock": "SponsorBlock",
        "settings.nav.bundle": "バンドル",
        "settings.section.language": "言語設定",
        "settings.section.general": "一般設定",
        "settings.section.download": "ダウンロード設定",
        "settings.section.subtitles": "字幕",
        "settings.section.metadata": "メタデータ",
        "settings.section.browser_cookies": "ブラウザクッキー",
        "settings.section.age_restricted": "成人向けコンテンツ",
        "settings.section.cookies_file": "クッキー（テキスト）",
        "settings.section.sponsorblock": "SponsorBlock",
        "settings.section.youtube": "YouTube",
        "settings.section.bundle": "バンドルツール",
        "settings.label.bundle.deno": "Deno",
        "settings.label.bundle.ffmpeg": "FFmpeg",
        "settings.label.bundle.path": "パス",
        "settings.label.bundle.override": "パス指定",
        "settings.value.bundle.present": "検出済み",
        "settings.value.bundle.missing": "未検出",
        "settings.button.bundle.refresh": "更新",
        "settings.button.bundle.download": "ダウンロード",
        "settings.help.bundle.download": "ダウンロードリンクはブラウザで開きます。",
        "settings.label.yt_player_clients": "プレイヤークライアント",
        "settings.label.language": "言語",
        "settings.label.download_dir": "保存フォルダ",
        "settings.label.outtmpl_default": "ファイル名テンプレート",
        "settings.label.outtmpl_playlist": "プレイリスト",
        "settings.label.output_format": "出力形式",
        "settings.label.video_quality": "画質",
        "settings.label.audio_quality": "音質",
        "settings.label.concurrent_fragments": "同時フラグメント数",
        "settings.label.retries": "再試行回数",
        "settings.option.prefer_largest_file": "最大ファイルサイズを優先",
        "settings.label.sub_langs": "字幕言語",
        "settings.label.cookies_browser": "ブラウザ",
        "settings.label.cookies_text": "cookies.txtの内容",
        "settings.label.sb_remove": "削除する区間",
        "settings.label.sb_mark": "チャプターとして表示",
        "settings.label.yt_remote_components": "JSチャレンジ解決",
        "settings.label.yt_po_token": "POトークン",
        "settings.option.remote_components.github": "有効化（GitHub）",
        "settings.option.remote_components.off": "無効",
        "settings.option.player_clients.web": "Webのみ",
        "settings.option.player_clients.web_android": "Web + Android",
        "settings.option.player_clients.auto": "自動（推奨）",
        "settings.help.yt_po_token": "例: android.gvs+TOKEN",
        "settings.warning.deno_missing": "Denoが見つかりません。JSチャレンジ解決が失敗する可能性があります。",
        "settings.warning.ffmpeg_missing": "FFmpegが見つかりません。高画質の結合が失敗する可能性があります（低画質にフォールバック）。",
        "settings.placeholder.cookies_text": "# Netscape HTTP Cookie File 形式",
        "settings.help.templates": "テンプレート変数: %(title)s, %(uploader)s, %(id)s, %(ext)s, %(playlist_title)s, %(playlist_index)s など",
        "settings.help.cookies_desc": "年齢制限やメンバーシップ動画をダウンロードするには\nブラウザのクッキーを使用してください。",
        "settings.help.age_desc": "※年齢制限動画をダウンロードするには「ブラウザクッキー使用」を\n有効にし、そのブラウザでYouTubeにログインしてください。",
        "settings.help.sponsorblock_desc": "スポンサー、イントロ、アウトロ等を自動で削除するか\nチャプターとして表示します。（APIキー不要）",
        "settings.help.sponsorblock_cats": "カテゴリ: sponsor, intro, outro, selfpromo, preview, filler, interaction, music_offtopic, all",
        "settings.tooltip.verify_download": "Best画質選択時にダウンロード後の整合性を確認",
        "settings.tooltip.sub_langs": "カンマ区切り（例: ja,en,ko）",
        "settings.tooltip.cookies_text": "Netscape形式のcookies.txt内容を貼り付け（www.youtube.com_cookies.txt形式を参照）",
        "settings.tooltip.age_restricted": "ブラウザクッキー使用時はYouTubeの年齢確認が必要です",
        "settings.tooltip.sponsorblock_mark": "削除せずチャプターとして表示するカテゴリ",
        "settings.option.verify_download": "ダウンロード後にファイル検証",
        "settings.option.write_subs": "字幕をダウンロード",
        "settings.option.write_auto_subs": "自動生成字幕を含める",
        "settings.option.embed_subs": "字幕を動画に埋め込む",
        "settings.option.embed_thumbnail": "サムネイルを埋め込む",
        "settings.option.embed_chapters": "チャプターを埋め込む",
        "settings.option.write_thumbnail": "サムネイルを別保存",
        "settings.option.add_metadata": "メタデータを追加（タイトル、アーティスト等）",
        "settings.option.use_cookies_from_browser": "ブラウザクッキーを使用",
        "settings.option.enable_age_restricted": "年齢制限動画を許可",
        "settings.option.sponsorblock_enable": "SponsorBlockを使用",
        "settings.format.mp4": "MP4 (.mp4)",
        "settings.format.mkv": "MKV (.mkv)",
        "settings.format.webm": "WebM (.webm)",
        "settings.format.mp3_audio": "MP3 (.mp3) - 音声",
        "settings.format.m4a_audio": "M4A (.m4a) - 音声",
        "settings.format.opus_audio": "Opus (.opus) - 音声",
        "settings.format.flac_audio": "FLAC (.flac) - 音声",
        "settings.video_quality.best": "最高画質 (Best)",
        "settings.video_quality.2160p": "4K (2160p)",
        "settings.video_quality.1440p": "2K (1440p)",
        "settings.video_quality.1080p": "Full HD (1080p)",
        "settings.video_quality.720p": "HD (720p)",
        "settings.video_quality.480p": "SD (480p)",
        "settings.video_quality.360p": "低画質 (360p)",
        "settings.video_quality.audio_only": "音声のみ",
        "settings.audio_quality.best": "最高音質 (Best)",
        "downloads.url_placeholder": "YouTube動画/プレイリストURLを入力（Ctrl+Enter）",
        "downloads.clipboard": "クリップボード",
        "downloads.clipboard_tooltip": "クリップボード自動検出",
        "downloads.sort_latest": "↓ 新しい順",
        "downloads.sort_oldest": "↑ 古い順",
        "downloads.download_button": "ダウンロード",
        "downloads.status.queued": "待機中",
        "downloads.status.done": "完了",
        "downloads.status.failed": "失敗",
        "downloads.error_title": "エラー詳細",
        "downloads.error_header": "ダウンロードエラー",
        "downloads.error_copy": "コピー",
        "downloads.error_close": "閉じる",
        "downloads.error_button": "⚠ エラー",
        "downloads.import_title": "読み込み",
        "downloads.import_filter": "URL List (*.txt *.csv)",
        "downloads.batch": "一括 ({count})",
        "downloads.menu.copy_link": "動画URLをコピー",
        "downloads.menu.restart": "再ダウンロード",
        "downloads.menu.restart_incomplete": "失敗した項目をすべて再ダウンロード",
        "downloads.menu.remove_completed": "正常にダウンロード済みの項目をすべて削除",
        "downloads.menu.delete_item": "削除",
        "downloads.menu.lock": "ロック",
        "dialog.select_folder": "フォルダーを選択",
        "dialog.select_file": "ファイルを選択",
    },
    "Chinese (Simplified)": {
        "app.title": "Tartaros",
        "menu.file": "文件",
        "menu.import_urls": "导入URL...",
        "menu.settings": "设置",
        "settings.title": "设置",
        "settings.save": "保存",
        "settings.nav.general": "常规",
        "settings.nav.download": "下载",
        "settings.nav.subs_meta": "字幕/元数据",
        "settings.nav.auth": "认证",
        "settings.nav.sponsorblock": "SponsorBlock",
        "settings.nav.bundle": "捆绑",
        "settings.section.language": "语言设置",
        "settings.section.general": "常规设置",
        "settings.section.download": "下载设置",
        "settings.section.subtitles": "字幕",
        "settings.section.metadata": "元数据",
        "settings.section.browser_cookies": "浏览器Cookie",
        "settings.section.age_restricted": "成人视频",
        "settings.section.cookies_file": "Cookie（文本）",
        "settings.section.sponsorblock": "SponsorBlock",
        "settings.section.youtube": "YouTube",
        "settings.section.bundle": "捆绑工具",
        "settings.label.bundle.deno": "Deno",
        "settings.label.bundle.ffmpeg": "FFmpeg",
        "settings.label.bundle.path": "路径",
        "settings.label.bundle.override": "指定路径",
        "settings.value.bundle.present": "已检测",
        "settings.value.bundle.missing": "未检测",
        "settings.button.bundle.refresh": "刷新",
        "settings.button.bundle.download": "下载",
        "settings.help.bundle.download": "下载链接将在浏览器中打开。",
        "settings.label.yt_player_clients": "播放器客户端",
        "settings.label.language": "语言",
        "settings.label.download_dir": "下载文件夹",
        "settings.label.outtmpl_default": "文件名模板",
        "settings.label.outtmpl_playlist": "播放列表",
        "settings.label.output_format": "输出格式",
        "settings.label.video_quality": "画质",
        "settings.label.audio_quality": "音质",
        "settings.label.concurrent_fragments": "并行分片数",
        "settings.label.retries": "重试次数",
        "settings.option.prefer_largest_file": "优先最大文件大小",
        "settings.label.sub_langs": "字幕语言",
        "settings.label.cookies_browser": "浏览器",
        "settings.label.cookies_text": "cookies.txt 内容",
        "settings.label.sb_remove": "移除片段",
        "settings.label.sb_mark": "标记为章节",
        "settings.label.yt_remote_components": "JS挑战处理",
        "settings.label.yt_po_token": "PO令牌",
        "settings.option.remote_components.github": "启用（GitHub）",
        "settings.option.remote_components.off": "关闭",
        "settings.option.player_clients.web": "仅Web",
        "settings.option.player_clients.web_android": "Web + Android",
        "settings.option.player_clients.auto": "自动（推荐）",
        "settings.help.yt_po_token": "示例: android.gvs+TOKEN",
        "settings.warning.deno_missing": "未找到Deno。JS挑战处理可能失败。",
        "settings.warning.ffmpeg_missing": "未找到FFmpeg。高画质合并可能失败（将回退为低画质）。",
        "settings.placeholder.cookies_text": "# Netscape HTTP Cookie File 格式",
        "settings.help.templates": "模板变量: %(title)s, %(uploader)s, %(id)s, %(ext)s, %(playlist_title)s, %(playlist_index)s 等",
        "settings.help.cookies_desc": "如需下载年龄限制或会员视频，请使用浏览器Cookie。",
        "settings.help.age_desc": "※要下载年龄限制视频，请启用“使用浏览器Cookie”，并在该浏览器登录YouTube。",
        "settings.help.sponsorblock_desc": "自动移除赞助/片头/片尾等，或标记为章节。（无需API Key）",
        "settings.help.sponsorblock_cats": "类别: sponsor, intro, outro, selfpromo, preview, filler, interaction, music_offtopic, all",
        "settings.tooltip.verify_download": "选择Best画质时，下载后校验文件完整性",
        "settings.tooltip.sub_langs": "逗号分隔（例如: zh,en,ja）",
        "settings.tooltip.cookies_text": "粘贴Netscape格式cookies.txt内容（参考www.youtube.com_cookies.txt格式）",
        "settings.tooltip.age_restricted": "使用浏览器Cookie时需要YouTube账号年龄验证",
        "settings.tooltip.sponsorblock_mark": "不移除而标记为章节的类别",
        "settings.option.verify_download": "下载后校验文件",
        "settings.option.write_subs": "下载字幕",
        "settings.option.write_auto_subs": "包含自动生成字幕",
        "settings.option.embed_subs": "将字幕嵌入视频",
        "settings.option.embed_thumbnail": "嵌入缩略图",
        "settings.option.embed_chapters": "嵌入章节",
        "settings.option.write_thumbnail": "单独保存缩略图",
        "settings.option.add_metadata": "添加元数据（标题、艺人等）",
        "settings.option.use_cookies_from_browser": "使用浏览器Cookie",
        "settings.option.enable_age_restricted": "允许年龄限制视频",
        "settings.option.sponsorblock_enable": "启用SponsorBlock",
        "settings.format.mp4": "MP4 (.mp4)",
        "settings.format.mkv": "MKV (.mkv)",
        "settings.format.webm": "WebM (.webm)",
        "settings.format.mp3_audio": "MP3 (.mp3) - 音频",
        "settings.format.m4a_audio": "M4A (.m4a) - 音频",
        "settings.format.opus_audio": "Opus (.opus) - 音频",
        "settings.format.flac_audio": "FLAC (.flac) - 音频",
        "settings.video_quality.best": "最高画质 (Best)",
        "settings.video_quality.2160p": "4K (2160p)",
        "settings.video_quality.1440p": "2K (1440p)",
        "settings.video_quality.1080p": "Full HD (1080p)",
        "settings.video_quality.720p": "HD (720p)",
        "settings.video_quality.480p": "SD (480p)",
        "settings.video_quality.360p": "低画质 (360p)",
        "settings.video_quality.audio_only": "仅音频",
        "settings.audio_quality.best": "最高音质 (Best)",
        "downloads.url_placeholder": "输入YouTube视频/播放列表链接（Ctrl+Enter）",
        "downloads.clipboard": "剪贴板",
        "downloads.clipboard_tooltip": "自动检测剪贴板",
        "downloads.sort_latest": "↓ 最新",
        "downloads.sort_oldest": "↑ 最旧",
        "downloads.download_button": "下载",
        "downloads.status.queued": "排队中",
        "downloads.status.done": "完成",
        "downloads.status.failed": "失败",
        "downloads.error_title": "错误详情",
        "downloads.error_header": "下载错误",
        "downloads.error_copy": "复制",
        "downloads.error_close": "关闭",
        "downloads.error_button": "⚠ 错误",
        "downloads.import_title": "导入",
        "downloads.import_filter": "URL List (*.txt *.csv)",
        "downloads.batch": "批量 ({count})",
        "downloads.menu.copy_link": "复制视频地址",
        "downloads.menu.restart": "重新下载",
        "downloads.menu.restart_incomplete": "重新下载所有失败项目",
        "downloads.menu.remove_completed": "移除所有已成功下载的项目",
        "downloads.menu.delete_item": "删除",
        "downloads.menu.lock": "锁定",
        "dialog.select_folder": "选择文件夹",
        "dialog.select_file": "选择文件",
    },
    "Chinese (Traditional)": {
        "app.title": "Tartaros",
        "menu.file": "檔案",
        "menu.import_urls": "匯入URL...",
        "menu.settings": "設定",
        "settings.title": "設定",
        "settings.save": "保存",
        "settings.nav.general": "一般",
        "settings.nav.download": "下載",
        "settings.nav.subs_meta": "字幕/中繼資料",
        "settings.nav.auth": "認證",
        "settings.nav.sponsorblock": "SponsorBlock",
        "settings.nav.bundle": "綑綁",
        "settings.section.language": "語言設定",
        "settings.section.general": "一般設定",
        "settings.section.download": "下載設定",
        "settings.section.subtitles": "字幕",
        "settings.section.metadata": "中繼資料",
        "settings.section.browser_cookies": "瀏覽器Cookie",
        "settings.section.age_restricted": "成人內容",
        "settings.section.cookies_file": "Cookie（文字）",
        "settings.section.sponsorblock": "SponsorBlock",
        "settings.section.youtube": "YouTube",
        "settings.section.bundle": "綑綁工具",
        "settings.label.bundle.deno": "Deno",
        "settings.label.bundle.ffmpeg": "FFmpeg",
        "settings.label.bundle.path": "路徑",
        "settings.label.bundle.override": "指定路徑",
        "settings.value.bundle.present": "已偵測",
        "settings.value.bundle.missing": "未偵測",
        "settings.button.bundle.refresh": "重新整理",
        "settings.button.bundle.download": "下載",
        "settings.help.bundle.download": "下載連結會在瀏覽器中開啟。",
        "settings.label.yt_player_clients": "播放器用戶端",
        "settings.label.language": "語言",
        "settings.label.download_dir": "下載資料夾",
        "settings.label.outtmpl_default": "檔名樣板",
        "settings.label.outtmpl_playlist": "播放清單",
        "settings.label.output_format": "輸出格式",
        "settings.label.video_quality": "畫質",
        "settings.label.audio_quality": "音質",
        "settings.label.concurrent_fragments": "同時分片數",
        "settings.label.retries": "重試次數",
        "settings.option.prefer_largest_file": "優先最大檔案大小",
        "settings.label.sub_langs": "字幕語言",
        "settings.label.cookies_browser": "瀏覽器",
        "settings.label.cookies_text": "cookies.txt 內容",
        "settings.label.sb_remove": "移除區段",
        "settings.label.sb_mark": "標記為章節",
        "settings.label.yt_remote_components": "JS挑戰處理",
        "settings.label.yt_po_token": "PO權杖",
        "settings.option.remote_components.github": "啟用（GitHub）",
        "settings.option.remote_components.off": "關閉",
        "settings.option.player_clients.web": "僅Web",
        "settings.option.player_clients.web_android": "Web + Android",
        "settings.option.player_clients.auto": "自動（推薦）",
        "settings.help.yt_po_token": "例: android.gvs+TOKEN",
        "settings.warning.deno_missing": "找不到Deno。JS挑戰處理可能失敗。",
        "settings.warning.ffmpeg_missing": "找不到FFmpeg。高畫質合併可能失敗（將回退為低畫質）。",
        "settings.placeholder.cookies_text": "# Netscape HTTP Cookie File 格式",
        "settings.help.templates": "樣板變數: %(title)s, %(uploader)s, %(id)s, %(ext)s, %(playlist_title)s, %(playlist_index)s 等",
        "settings.help.cookies_desc": "如需下載年齡限制或會員影片，請使用瀏覽器Cookie。",
        "settings.help.age_desc": "※要下載年齡限制影片，請啟用「使用瀏覽器Cookie」，並在該瀏覽器登入YouTube。",
        "settings.help.sponsorblock_desc": "自動移除贊助/片頭/片尾等，或標記為章節。（不需API Key）",
        "settings.help.sponsorblock_cats": "類別: sponsor, intro, outro, selfpromo, preview, filler, interaction, music_offtopic, all",
        "settings.tooltip.verify_download": "選擇Best畫質時，下載後驗證檔案完整性",
        "settings.tooltip.sub_langs": "以逗號分隔（例如: zh,en,ja）",
        "settings.tooltip.cookies_text": "貼上Netscape格式cookies.txt內容（參考www.youtube.com_cookies.txt格式）",
        "settings.tooltip.age_restricted": "使用瀏覽器Cookie時需要YouTube帳號年齡驗證",
        "settings.tooltip.sponsorblock_mark": "不移除而標記為章節的類別",
        "settings.option.verify_download": "下載後驗證檔案",
        "settings.option.write_subs": "下載字幕",
        "settings.option.write_auto_subs": "包含自動生成字幕",
        "settings.option.embed_subs": "將字幕嵌入影片",
        "settings.option.embed_thumbnail": "嵌入縮圖",
        "settings.option.embed_chapters": "嵌入章節",
        "settings.option.write_thumbnail": "另存縮圖",
        "settings.option.add_metadata": "加入中繼資料（標題、藝人等）",
        "settings.option.use_cookies_from_browser": "使用瀏覽器Cookie",
        "settings.option.enable_age_restricted": "允許年齡限制影片",
        "settings.option.sponsorblock_enable": "啟用SponsorBlock",
        "settings.format.mp4": "MP4 (.mp4)",
        "settings.format.mkv": "MKV (.mkv)",
        "settings.format.webm": "WebM (.webm)",
        "settings.format.mp3_audio": "MP3 (.mp3) - 音訊",
        "settings.format.m4a_audio": "M4A (.m4a) - 音訊",
        "settings.format.opus_audio": "Opus (.opus) - 音訊",
        "settings.format.flac_audio": "FLAC (.flac) - 音訊",
        "settings.video_quality.best": "最高畫質 (Best)",
        "settings.video_quality.2160p": "4K (2160p)",
        "settings.video_quality.1440p": "2K (1440p)",
        "settings.video_quality.1080p": "Full HD (1080p)",
        "settings.video_quality.720p": "HD (720p)",
        "settings.video_quality.480p": "SD (480p)",
        "settings.video_quality.360p": "低畫質 (360p)",
        "settings.video_quality.audio_only": "僅音訊",
        "settings.audio_quality.best": "最高音質 (Best)",
        "downloads.url_placeholder": "輸入YouTube影片/播放清單連結（Ctrl+Enter）",
        "downloads.clipboard": "剪貼簿",
        "downloads.clipboard_tooltip": "自動偵測剪貼簿",
        "downloads.sort_latest": "↓ 最新",
        "downloads.sort_oldest": "↑ 最舊",
        "downloads.download_button": "下載",
        "downloads.status.queued": "等待中",
        "downloads.status.done": "完成",
        "downloads.status.failed": "失敗",
        "downloads.error_title": "錯誤詳情",
        "downloads.error_header": "下載錯誤",
        "downloads.error_copy": "複製",
        "downloads.error_close": "關閉",
        "downloads.error_button": "⚠ 錯誤",
        "downloads.import_title": "匯入",
        "downloads.import_filter": "URL List (*.txt *.csv)",
        "downloads.batch": "批次 ({count})",
        "downloads.menu.copy_link": "複製影片網址",
        "downloads.menu.restart": "重新下載",
        "downloads.menu.restart_incomplete": "重新下載所有失敗項目",
        "downloads.menu.remove_completed": "移除所有成功下載的項目",
        "downloads.menu.delete_item": "刪除",
        "downloads.menu.lock": "鎖定",
        "dialog.select_folder": "選擇資料夾",
        "dialog.select_file": "選擇檔案",
    },
}


class I18n(QObject):
    language_changed = Signal()

    def notify_language_changed(self):
        self.language_changed.emit()


i18n = I18n()


def _normalize_language(value: str) -> str:
    raw = (value or "").strip()
    if not raw:
        return "English"
    lower = raw.lower()
    aliases = {
        "en": "English",
        "english": "English",
        "ko": "Korean",
        "korean": "Korean",
        "한국어": "Korean",
        "ja": "Japanese",
        "japanese": "Japanese",
        "日本語": "Japanese",
        "zh-cn": "Chinese (Simplified)",
        "zh-hans": "Chinese (Simplified)",
        "简体中文": "Chinese (Simplified)",
        "zh-tw": "Chinese (Traditional)",
        "zh-hant": "Chinese (Traditional)",
        "繁體中文": "Chinese (Traditional)",
    }
    return aliases.get(lower, raw)


def tr(key: str) -> str:
    lang = _normalize_language(SettingsStore.load().language)
    return _TRANSLATIONS.get(lang, _TRANSLATIONS["English"]).get(key, key)
